# PR-Curve (Precision-Recall Curve)
**PR-Curve (Precision-Recall Curve)** — это графическое представление зависимости **точности (Precision)** от **полноты (Recall)** модели. Эта кривая используется для анализа производительности модели детекции объектов, особенно в задачах, где важно оценить баланс между точностью и полнотой.

В библиотеке **Ultralytics**, которая предоставляет реализацию моделей YOLO (You Only Look Once), PR-Curve автоматически генерируется после завершения обучения или валидации модели. Она помогает оценить, насколько хорошо модель справляется с обнаружением объектов при различных уровнях уверенности.



## Что такое Precision и Recall?

Прежде чем разбирать PR-Curve, важно понять, что такое **Precision** и **Recall**.

### 1. **Precision (точность)**:
Precision — это доля правильно предсказанных объектов среди всех предсказанных объектов. Формула:

**Precision = TP / (TP + FP)**

Где:
- **TP (True Positives)** — количество правильно предсказанных объектов.
- **FP (False Positives)** — количество ложных срабатываний.

### 2. **Recall (полнота)**:
Recall — это доля правильно предсказанных объектов среди всех истинных объектов. Формула:

**Recall = TP / (TP + FN)**


Где:
- **FN (False Negatives)** — количество пропущенных объектов.



## Что такое PR-Curve?

**PR-Curve** — это график, который показывает, как меняется **Precision** в зависимости от **Recall** при изменении порога уверенности (**confidence threshold**).

### Как строится PR-Curve?
1. Модель делает предсказания для тестового набора данных.
2. Для каждого возможного порога уверенности (например, от 0 до 1 с шагом 0.01):
   - Вычисляются TP, FP и FN.
   - Рассчитываются Precision и Recall.
3. По оси X откладывается Recall, а по оси Y — Precision.
4. Соединяя точки, получается кривая.



## Зачем использовать PR-Curve?

1. **Оценка баланса между Precision и Recall**:
   PR-Curve помогает найти оптимальный баланс между точностью и полнотой. Например:
   - Высокая Precision означает, что модель делает мало ошибок, но может пропускать объекты.
   - Высокий Recall означает, что модель находит большинство объектов, но может делать много ложных срабатываний.

2. **Анализ поведения модели**:
   Кривая показывает, как изменяется Precision при увеличении Recall. Это особенно важно для задач с дисбалансом классов, где важна точность предсказаний.

3. **Сравнение моделей**:
   PR-Curve позволяет сравнить производительность разных моделей, особенно если они обучены на разных датасетах или имеют разные гиперпараметры.



## Как Ultralytics использует PR-Curve?

В библиотеке **Ultralytics** PR-Curve автоматически генерируется после завершения обучения или валидации модели. Она доступна как часть отчета о производительности модели и может быть визуализирована в виде графика.

### Пример использования:
После запуска обучения модели YOLOv8 с помощью скрипта `train.py`, Ultralytics выводит PR-Curve в папке результатов. Это помогает понять:
- Как модель реагирует на изменения порога уверенности.
- Какой баланс между Precision и Recall достигается.
- Есть ли проблемы с ложными срабатываниями или пропусками объектов.



## Как интерпретировать PR-Curve?

1. **Форма кривой**:
   - Идеальная PR-Curve имеет форму прямоугольника: высокая Precision сохраняется даже при высоком Recall.
   - Реальная кривая обычно имеет наклон вниз: Precision снижается с увеличением Recall.

2. **Площадь под кривой (AUC)**:
   - Чем больше площадь под PR-Curve, тем лучше производительность модели.
   - AUC (Area Under Curve) используется как количественная метрика для сравнения моделей.

3. **Точки на кривой**:
   - Точка, где Precision и Recall близки к 1, указывает на оптимальный баланс.
   - Если Precision падает резко при увеличении Recall, это может указывать на проблемы с качеством модели.


## Как использовать PR-Curve для улучшения модели?

1. **Настройка порога уверенности**:
   - Используйте PR-Curve для выбора порога уверенности, который обеспечивает оптимальный баланс между Precision и Recall.

2. **Анализ проблемных областей**:
   - Если Precision низкий при высоком Recall, это может указывать на большое количество ложных срабатываний.
   - Если Recall низкий при высоком Precision, это может указывать на пропуски истинных объектов.

3. **Оптимизация модели**:
   - Если PR-Curve не достигает высоких значений, рассмотрите возможность улучшения модели (например, добавление данных, настройка гиперпараметров).



## Заключение

**PR-Curve** — это мощный инструмент для анализа производительности модели в библиотеке Ultralytics. Она помогает:
- Найти оптимальный баланс между точностью и полнотой.
- Выявить проблемные области (например, ложные срабатывания или пропуски объектов).
- Сравнить производительность разных моделей.

Используйте PR-Curve для более глубокого понимания работы вашей модели и принятия решений о дальнейшей оптимизации.